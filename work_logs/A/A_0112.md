# Relationship Extraction Prompt v1.0

## Overview

This document summarizes the **v1.0 logical structure** of a
relationship-extraction prompt designed for literary texts.\
The novel *The Murder of Roger Ackroyd* is used as the **test example**.

The core idea:

> **Relationship = Core Relationship (always available) + Type-Specific
> Enhanced Relationship (enabled by text type)**

Only **one final relationship type** is assigned per character pair.

------------------------------------------------------------------------

## 1. Core Relationships (Always Enabled)

### üåê Core Relationships

``` json
{
  "core_relationships": [
    "family",
    "lover",
    "ally",
    "enemy",
    "authority"
  ]
}
```

### Key Principles

-   **Undirected**: no `from` / `to`
-   Represents *what kind of relationship exists*, not who acts on whom
-   Fixed semantics: the same character pair cannot have conflicting
    weights or multiple types
-   Selection priority:
    1.  Use a **type-specific relationship** if clearly identifiable
    2.  Otherwise, **fall back to a core relationship**
    3.  **Exactly one relationship type** per character pair

------------------------------------------------------------------------

## 2. Type-Specific Enhanced Relationships

These relationships are **only enabled when the text type matches**.

------------------------------------------------------------------------

### üß† Detective / Mystery

``` json
{
  "detective_relations": [
    "suspect",
    "investigate",
    "alibi",
    "secret"
  ]
}
```

Interpretation:

-   `suspect`: suspicion or implication between two characters
-   `secret`: significant concealment between characters

------------------------------------------------------------------------

### ‚ù§Ô∏è Romance / Drama

``` json
{
  "romance_relations": [
    "unrequited_love",
    "betrayal",
    "triangle"
  ]
}
```

------------------------------------------------------------------------

### üëë Historical / Political

``` json
{
  "historical_relations": [
    "power_struggle",
    "rebellion",
    "conspiracy"
  ]
}
```

------------------------------------------------------------------------

### üß¨ Sci-Fi / Fantasy

``` json
{
  "fantasy_relations": [
    "mentor",
    "chosen_one",
    "magical_bond"
  ]
}
```

------------------------------------------------------------------------

### üìò Biography / Non-fiction

``` json
{
  "nonfiction_relations": [
    "collaboration",
    "influence",
    "opposition"
  ]
}
```

------------------------------------------------------------------------

## 3. Production-Ready English Prompt

### Purpose

Given a text chunk or short passage, the model must output:

-   Character list
-   A **single relationship type per character pair**
-   Weight (0--1)
-   Natural-language description

Strictly following the defined rules.

------------------------------------------------------------------------

### SYSTEM / DEVELOPER PROMPT

``` text
You are an expert literary relationship analyst.

Your task is to extract characters and the primary relationship between each pair of characters from the given text.

IMPORTANT RULES:

1. Relationship Direction:
- Relationships are UNDIRECTED.
- There is NO "from" or "to".
- A relationship applies equally to both characters.

2. Relationship Selection Priority:
- First, try to assign a TYPE-SPECIFIC relationship based on the given text_type.
- If no clear type-specific relationship can be identified, fall back to one CORE relationship.
- Output ONLY ONE final relationship_type per character pair.

3. Core Relationships (always available):
- family
- lover
- ally
- enemy
- authority

4. Type-Specific Relationships (allowed ONLY if text_type matches):

Detective / Mystery:
- suspect
- investigate
- alibi
- secret

Romance / Drama:
- unrequited_love
- betrayal
- triangle

Historical / Political:
- power_struggle
- rebellion
- conspiracy

Sci-Fi / Fantasy:
- mentor
- chosen_one
- magical_bond

Biography / Non-fiction:
- collaboration
- influence
- opposition

5. Weight:
- weight is a number between 0 and 1.
- It represents the strength or importance of the relationship in the text.

6. Description:
- A short natural-language explanation of the relationship.
- Do NOT quote the text.
- Do NOT mention chapters or timestamps.

7. Output Format:
- Output valid JSON only.
- Follow the schema exactly.
- Do NOT add extra fields.
```

------------------------------------------------------------------------

## 4. Expected JSON Output Format

``` json
{
  "text_type": "detective",
  "characters": [
    { "id": "C1", "name": "Character Name" }
  ],
  "relationships": [
    {
      "characters": ["C1", "C2"],
      "relationship_type": "suspect",
      "weight": 0.75,
      "description": "A brief explanation of the relationship between the two characters."
    }
  ]
}
```

------------------------------------------------------------------------

## Status

-   Logical structure: **v1.0 completed**
-   Next steps:
    -   Prompt stress testing
    -   Edge-case handling
    -   Multi-chunk consistency checks
